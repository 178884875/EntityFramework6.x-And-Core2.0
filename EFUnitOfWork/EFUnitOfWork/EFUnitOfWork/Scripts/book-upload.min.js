(function(n){function i(n,t){for(var u=[],f=n[0],h=3145728,i=0,e=h,l=f.size,o,s,c;i<l;)u.push(f.slice(i,e)),i=e,e=i+h;for(o=u.length,s=0;chunk=u.shift();)s++,c=f.name+".part_"+s+"."+o,r(chunk,c,o,t)}function r(i,r,f,e){var o=new FormData;o.append("file",i,r);n.ajax({type:"POST",url:"/book/upload/"+e,contentType:!1,processData:!1,data:o,success:function(){t++;var n=(t/f).toFixed(2)*100;u(n)},error:function(n){console.log(n)}})}function u(t){var r=n(".js-loading-bar"),i=r.find(".progress-bar");i.css("width",t+"%");i.html(parseInt(t)+"%");t==100&&(setTimeout(function(){i.removeClass("animate");r.modal("hide")},1500),n("#uploadFile").val(""),n("#btnSubmit").removeAttr("disabled"))}var t=0;n(function(){n("#uploadFile").fileinput();n("#btnSubmit").click(function(){var t,r,u;if(n("#uploadFile")[0].files.length<=0){alert("请上传文件");return}n(this).prop("disabled","disabled");t=n(".js-loading-bar");r=t.find(".progress-bar");t.modal("show");r.addClass("animate");u=n("#ID").val();i(n("#uploadFile")[0].files,u)})})})(jQuery);